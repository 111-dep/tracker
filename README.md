# Solana 钱包资产分析工具 v0.5

一个专注于 Solana 链上资产分析的命令行工具，支持多钱包资产追踪、实时价格更新和完整的计算过程展示。

## 系统架构

### 1. 数据获取层
- **钱包数据源**
  - Helius DAS API: 获取代币详细信息（名称、符号、小数位）
  - RPC API: 作为备选数据源，确保数据完整性
  - 并发处理: 同时处理多个钱包地址

- **价格数据源**
  - Jupiter API v2: 主要价格来源，提供实时价格和可信度
  - CoinMarketCap API: 备选价格源（可配置）

### 2. 数据处理层
- **代币数据处理**
  - 自动合并同类代币账户
  - 智能处理代币精度（decimals）
  - 过滤空账户和无效代币

- **价格处理**
  - 多级可信度评估 (high/medium/low)
  - 异常价格过滤
  - 价格合理性检查

### 3. 计算引擎
- **资产计算**
  ```
  代币价值 = 原始数量 * 当前价格
  总价值 = Σ(每个代币价值)
  ```

- **性能优化**
  - 批量处理代币价格查询
  - 并发处理多钱包数据
  - 智能请求限流

## 功能特性

### 1. 多钱包支持
- 支持同时分析多个钱包地址
- 智能合并相同代币的持仓
- 钱包标签化管理

### 2. 资产发现
- 自动发现所有代币账户
- 支持 SPL 代币和原生 SOL
- Associated Token Account (ATA) 识别

### 3. 价格追踪
- 实时价格更新
- 多级可信度评估
- 异常价格过滤

### 4. 报告生成
- 完整的计算过程展示
- 按价值排序的 TOP 50 代币
- 可信度标注

## 配置说明

### 1. 环境配置（.env）
```env
HELIUS_RPC_ENDPOINT=YOUR_ENDPOINT
HELIUS_API_KEY=YOUR_API_KEY
CMC_API_KEY=YOUR_CMC_API_KEY  # 可选
```

### 2. 钱包配置（config/wallets.yaml）
```yaml
wallets:
  - address: "钱包地址1"
    label: "wm-01"
  - address: "钱包地址2"
    label: "wm-02"
  # ... 最多支持10个钱包
```

## 使用方法

### 1. 初始化
```bash
# 安装依赖
go mod download

# 复制环境配置
cp .env.example .env
```

### 2. 运行方式
```bash
# 分析所有配置的钱包
go run main.go -all

# 分析单个钱包
go run main.go -wallet YOUR_WALLET_ADDRESS

# 使用自定义配置
go run main.go -all -config custom_wallets.yaml
```

## 实现细节

### 1. 数据获取流程
1. 并发获取多个钱包数据
2. 每个钱包并行查询 DAS 和 RPC
3. 智能合并数据源结果
4. 批量获取代币价格

### 2. 计算处理流程
1. 合并同类代币账户
2. 处理代币精度
3. 获取实时价格
4. 计算代币价值
5. 生成持仓报告

### 3. 报告生成
1. 按价值排序
2. 展示详细计算过程
3. 标注可信度级别
4. 输出 TOP 50 代币

## 下一步计划 (v0.6)

### 1. 实时监控系统
- 代币数量变化追踪
- 价值变化速率计算
- 大额变动预警

### 2. 监控指标
- 数量变化率 (Δquantity/Δt)
- 价值变化率 (Δvalue/Δt)
- 价格波动率

### 3. 预警机制
- 自定义阈值告警
- 多级别预警
- 变化趋势分析

## 注意事项

1. 数据准确性
   - 使用多数据源交叉验证
   - 仅使用高可信度价格
   - 完整展示计算过程

2. 性能考虑
   - 并发请求限流
   - 智能批处理
   - 超时控制

3. 安全性
   - 仅读取链上数据
   - 本地存储敏感配置
   - API 密钥严格保密

## 许可证

MIT License 